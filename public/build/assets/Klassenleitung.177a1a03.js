import{u as R,M as K,T as G}from"./Menubar.c0f0f313.js";import{_ as H,a as Z}from"./checkbox-line.2fcee81a.js";import{_ as T}from"./plugin-vue_export-helper.21dcd24c.js";import{d as B,b as h,o as g,c as x,u as s,f as O,w as c,g as t,p as V,i as A,e as r,a as M,l as S,h as C,k as Y,t as U,A as q,B as J,y as E,j as F,m as P}from"./app.97da3a2c.js";/* empty css            */const L=l=>(V("data-v-a85104d2"),l=l(),A(),l),Q=L(()=>r("span",{class:"sr-only"},"Ist ausgef\xFCllt",-1)),W=L(()=>r("span",{class:"sr-only"},"Ist nicht ausgef\xFCllt",-1)),X=B({__name:"BemerkungenIndicator",props:{bemerkung:Boolean},emits:["open"],setup(l,{emit:_}){const u=l,e=()=>_("open");return(b,k)=>{const f=H,m=h("SvwsUiIcon"),v=Z;return g(),x("button",{onClick:e},[s(u).bemerkung?(g(),O(m,{key:0},{default:c(()=>[Q,t(f,{"aria-hidden":"true"})]),_:1})):(g(),O(m,{key:1},{default:c(()=>[W,t(v,{"aria-hidden":"true"})]),_:1}))])}}});var I=T(X,[["__scopeId","data-v-a85104d2"]]);const ee={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ne=r("path",{fill:"currentColor",d:"m12 10.586l4.95-4.95l1.414 1.414l-4.95 4.95l4.95 4.95l-1.414 1.414l-4.95-4.95l-4.95 4.95l-1.414-1.414l4.95-4.95l-4.95-4.95L7.05 5.636z"},null,-1),te=[ne];function le(l,_){return g(),x("svg",ee,te)}var se={name:"ri-close-line",render:le};const j=l=>(V("data-v-bae04f58"),l=l(),A(),l),oe={class:"flex flex-col gap-6"},re=j(()=>r("h2",{class:"headline-4"},"Floskeln",-1)),ae=j(()=>r("hr",{class:"border-gray"},null,-1)),ce={class:"pb-0"},ue={class:"h-full overflow-y-scroll"},ie=C("Zuweisen"),pe=B({__name:"FloskelTable",props:{floskelgruppe:String,floskelgruppen:Array},emits:["added"],setup(l,{emit:_}){const u=l,e=M({selected:[],search:"",floskelgruppen:u.floskelgruppen,floskelgruppe:u.floskelgruppe}),b=[{key:"id",label:"id",sortable:!0},{key:"kuerzel",label:"K\xFCrzel",sortable:!0},{key:"text",label:"Text",sortable:!0}],k=S(()=>e.floskelgruppen.find(i=>i.kuerzel==e.floskelgruppe).floskeln.filter(i=>f(i))),f=i=>e.search==""?!0:i.text.toLowerCase().includes(e.search.toLowerCase()),m=i=>e.selected=i,v=()=>{let i=e.selected.map(n=>n.text).join(" ");_("added",i)},d=S(()=>e.selected.length>0?"primary":"secondary");return(i,n)=>{const a=h("SvwsUiTextInput"),o=h("SvwsUiButton"),p=h("SvwsUiNewTable");return g(),x("div",oe,[re,ae,r("div",ce,[t(a,{type:"search",modelValue:e.search,"onUpdate:modelValue":n[0]||(n[0]=w=>e.search=w),placeholder:"Suche"},null,8,["modelValue"])]),r("div",ue,[t(p,{data:s(k),columns:s(b),selectionMode:"multiple",footer:!0,"onUpdate:modelValue":m},{footer:c(()=>[t(o,{onClick:v,type:s(d)},{default:c(()=>[ie]),_:1},8,["type"])]),_:1},8,["data","columns"])])])}}});var de=T(pe,[["__scopeId","data-v-bae04f58"]]);const _e=l=>(V("data-v-27d61bc4"),l=l(),A(),l),me={key:0,class:"bg-white border-dark p-6 z-50 fixed top-0 right-0 bottom-0 w-1/2 border-l-2 border-black/20 flex flex-col gap-6"},he={class:"flex gap-6 justify-between"},ge={class:"flex gap-6 items-center"},ke={class:"headline-1 text-black"},fe=_e(()=>r("span",{class:"sr-only"},"Schlie\xDFen",-1)),ve={class:"flex flex-col h-full gap-12"},be={class:"h-1/3 flex flex-col gap-3"},xe={class:"flex gap-3"},we=C("Speichern"),ye=C("Verwerfen"),$e={key:0,class:"h-1/3 flex flex-col gap-3 mt-3"},Se=B({__name:"FloskelnMenu",props:{selected:null,floskelgruppen:null},emits:["close","updated"],setup(l,{emit:_}){const u=l;let e=M({bemerkung:"",storedBemerkung:"",schueler:null,isDirty:!1,floskelgruppen:[],columns:[{id:"kuerzel",title:"K\xFCrzel",sortable:!0},{id:"text",title:"Text",sortable:!0}]});Y(()=>u.selected,n=>{e.schueler=n==null?void 0:n.schueler,e.bemerkung=e.storedBemerkung=n==null?void 0:n.schueler[n==null?void 0:n.floskelgruppe],e.floskelgruppen=u.floskelgruppen});const b=S(()=>{if(e.isDirty=e.bemerkung!=e.storedBemerkung,!e.bemerkung)return;const n=/\$VORNAME\$ \$NACHNAME\$|\$VORNAME\$|\$Vorname\$|\$NACHNAME\$/;let a=e.schueler,o={m:"Er",w:"Sie"},p=o[a.geschlecht]!==void 0?o[a.geschlecht]:null,w={"$vorname$ $nachname$":[a.vorname,a.nachname].join(" "),$vorname$:a.vorname,$nachname$:a.nachname},y={"$vorname$ $nachname$":p!=null?p:a.vorname,$vorname$:p!=null?p:a.vorname,$nachname$:null};return e.bemerkung.replace(new RegExp(n,"i"),$=>w[$.toLowerCase()]).replaceAll(new RegExp(n,"gi"),$=>y[$.toLowerCase()])}),k=n=>e.bemerkung=n,f=()=>{var o;let n=route("set_schueler_bemerkung",e.schueler.id),a={[(o=u.selected)==null?void 0:o.floskelgruppe]:e.bemerkung};F.post(n,a).then(()=>{_("updated"),e.storedBemerkung=e.bemerkung,e.isDirty=!1})},m=S(()=>e.floskelgruppen.find(n=>n.kuerzel==u.selected.floskelgruppe)),v=n=>e.bemerkung=[e.bemerkung,n].join(" ").trim(),d="Achtung die \xC4nderungen sind noch nicht gespeichert! Diese gehen verloren, wenn Sie fortfahren.",i=()=>{(!e.isDirty||confirm(d))&&_("close")};return window.addEventListener("beforeunload",n=>{if(e.isDirty)return(n||window.event).returnValue=d,d;_("close")},{capture:!0}),(n,a)=>{var z,N;const o=h("SvwsUiBadge"),p=se,w=h("SvwsUiIcon"),y=h("SvwsUiButton"),$=h("SvwsUiTextareaInput");return s(u).selected?(g(),x("aside",me,[r("header",he,[r("div",ge,[r("h1",ke,U((z=s(e).schueler)==null?void 0:z.nachname)+", "+U((N=s(e).schueler)==null?void 0:N.vorname),1),t(o,{variant:"highlight",size:"big",class:"px-6 uppercase"},{default:c(()=>{var D;return[C(U((D=s(u).selected)==null?void 0:D.floskelgruppe),1)]}),_:1})]),t(y,{onClick:i,type:"transparent"},{default:c(()=>[t(w,null,{default:c(()=>[fe,t(p,{"aria-hidden":"true"})]),_:1})]),_:1})]),r("div",ve,[r("div",be,[t($,{resizeable:"none",class:"flex-1",modelValue:s(b),placeholder:"Tragen Sie bitte hier Ihre Bemerkungen ein.","onUpdate:modelValue":k},null,8,["modelValue"]),r("div",xe,[t(y,{onClick:f,type:s(e).isDirty?"primary":"secondary"},{default:c(()=>[we]),_:1},8,["type"]),q(t(y,{onClick:i,type:"secondary"},{default:c(()=>[ye]),_:1},512),[[J,s(e).isDirty]])])]),s(m)?(g(),x("div",$e,[t(de,{floskelgruppe:"zb",floskelgruppen:s(u).floskelgruppen,onAdded:v},null,8,["floskelgruppen"])])):E("",!0)])])):E("",!0)}}});var Be=T(Se,[["__scopeId","data-v-27d61bc4"]]);const Ce={class:"relative flex flex-col w-full h-screen"},Ue={class:"h-full flex-1 overflow-auto"},Me=B({__name:"Klassenleitung",props:{auth:Object},setup(l){const _=l,u=R();let e=M({floskelgruppen:[],schueler:[],selected:null});const b=[{key:"vorname",label:"Vorname",sortable:!0},{key:"nachname",label:"Nachname",sortable:!0},{key:"asv",label:"Asv",sortable:!0},{key:"aue",label:"Aue",sortable:!0},{key:"zb",label:"Zb",sortable:!0}];P(()=>{k(),f()});const k=()=>F.get(route("get_schueler")).then(d=>e.schueler=d.data),f=()=>F.get(route("get_floskeln")).then(d=>e.floskelgruppen=d.data),m=d=>e.selected=d,v=()=>e.selected=null;return(d,i)=>{const n=h("SvwsUiNewTable"),a=h("SvwsUiAppLayout");return g(),x("div",null,[t(a,{collapsed:s(u).sidebarCollapsed},{sidebar:c(()=>[t(K,{auth:s(_).auth},null,8,["auth"])]),main:c(()=>[r("div",Ce,[t(G,{headline:"Klassenleitung"}),r("div",Ue,[t(n,{data:s(e).schueler,columns:s(b),class:"relative"},{"cell-asv":c(({row:o})=>[t(I,{onOpen:p=>m({schueler:o,floskelgruppe:"asv"}),bemerkung:Boolean(o.asv)},null,8,["onOpen","bemerkung"])]),"cell-aue":c(({row:o})=>[t(I,{onOpen:p=>m({schueler:o,floskelgruppe:"aue"}),bemerkung:Boolean(o.aue)},null,8,["onOpen","bemerkung"])]),"cell-zb":c(({row:o})=>[t(I,{onOpen:p=>m({schueler:o,floskelgruppe:"zb"}),bemerkung:Boolean(o.zb)},null,8,["onOpen","bemerkung"])]),_:1},8,["data","columns"])])])]),contentSidebar:c(()=>[t(Be,{selected:s(e).selected,floskelgruppen:s(e).floskelgruppen,onClose:v,onUpdated:k},null,8,["selected","floskelgruppen"])]),_:1},8,["collapsed"])])}}});export{Me as default};
